# 线性递推式求解项目

## 背景介绍

小H是一个大学生，他的弟弟在上小学，目前小H的弟弟马上就要过暑假了，小H又想到了被小学数学找规律的题目支配的恐惧。

所以小H决心通过上课所学习的算法导论课程的知识，去克服对小学找规律课后题的恐惧。

## 问题描述

对于给定的n个数 s₀, s₁, ..., s_{n-1}，要求找到其线性递推式，并且给出符合此算法的第m个数 s_{m-1} 是什么。（m可能远远大于n）

**注：** 显然线性递推式有可能不唯一，故只需要输出对应的最短线性递推式即可。

### 线性递推式和最短线性递推式

**线性递推式** 是描述数列项之间线性关系的重要数学工具。给定数列 {aₙ}，一个k阶线性递推式定义为：

```
aₙ = c₁·a_{n-1} + c₂·a_{n-2} + ... + cₖ·a_{n-k}, n ≥ k
```

其中 c₁, c₂, ..., cₖ ∈ ℝ 且 cₖ ≠ 0。

**最短线性递推式** 是指能够描述给定数列的所有线性递推式中阶数最小的那一个。

## 示例

### 基本示例

1. **累加数列**: s = [1, 2, 3, 4, 5]
   - 递推式: sₙ = 2·s_{n-1} - s_{n-2}
   - 第100项: s₉₉ = 100

2. **累乘数列**: s = [1, 2, 4, 8, 16]
   - 递推式: sₙ = 2·s_{n-1}
   - 第100项: s₉₉ = 2⁹⁹

3. **斐波那契数列**: s = [0, 1, 1, 2, 3]
   - 递推式: sₙ = s_{n-1} + s_{n-2}
   - 第100项: s₉₉ = 354224848179261915075

## 算法设计

### 求解线性递推式

#### 1. BM算法（求最短线性递推式）

BM算法是求解最短线性递推式的经典算法，主要应用于BCH解码和LFSR的合成。

**算法核心思想**：
- 基于贪心的增量构造
- 从序列第一项开始，逐步扩展考虑的序列长度
- 维护能够生成当前所有已知项的最短连接多项式

**时间复杂度**: O(N²)
**空间复杂度**: O(N)

#### 2. 高斯消元法（求最短线性递推式）

高斯消元法通过构造线性方程组来求解最短线性递推式。

**算法核心思想**：
- 尝试不同长度的递推式（从1开始）
- 构造线性方程组 A·x = b，其中 x 是递推式系数
- 使用高斯消元法求解方程组
- 验证解的正确性，找到最短的有效递推式

**时间复杂度**: O(N⁴)（最坏情况）
**空间复杂度**: O(N²)

### 3. 快速计算第m项

获得线性递推式后，有多种方法计算第m项：

#### 方法一：矩阵快速幂
- 时间复杂度: O(L³ log m)
- 空间复杂度: O(L²)

#### 方法二：多项式快速幂
- 时间复杂度: O(L² log m)
- 空间复杂度: O(L)

#### 方法三：FFT/NTT优化
- 时间复杂度: O(L log L log m)
- 空间复杂度: O(L)

## 算法复杂度对比

| 算法 | 单次运算 | 总体复杂度 | 空间复杂度 |
|------|----------|------------|------------|
| 直接递推 | O(L) | O(L·m) | O(L) |
| 朴素矩阵快速幂 | O(L³) | O(L³ log m) | O(L²) |
| 朴素多项式快速幂 | O(L²) | O(L² log m) | O(L) |
| FFT优化多项式 | O(L log L) | O(L log L log m) | O(L) |
| NTT优化多项式 | O(L log L) | O(L log L log m) | O(L) |

## 项目结构

- `berlekamp_massey.cpp` - NTT优化的Berlekamp-Massey算法实现
- `gaussian_elimination.cpp` - 高斯消元法求递推式实现  (求解使用NTT)
- `matrix_power.cpp` - 矩阵快速幂算法实现
- `poly_multiply.cpp` - 多项式乘法优化算法实现
- `naive.cpp` - 朴素算法实现
- `test1.bat` - Windows自动化测试1脚本
- `test1.sh` - Linux/Unix自动化测试1脚本
- `test2.bat` - Windows自动化测试2脚本
- `test2.sh` - Linux/Unix自动化测试2脚本
- `in/` - 测试输入文件目录
- `out/` - 预期输出文件目录

## 使用方法

### Windows环境

1. 评测求解线性递推式算法

   ```cmd
   test1.bat
   ```

2. 评测计算第m项的算法

   ```cmd
   test2.bat
   ```

### Linux/Unix环境

1. 评测求解线性递推式算法

   ```bash
   chmod +x test1.sh
   ./test1.sh
   ```

2. 评测计算第m项的算法

   ```bash
   chmod +x test2.sh
   ./test2.sh
   ```

## 输入格式

第一行：两个整数 n 和 m，表示给定序列长度和要求的项数
第二行：n个整数，表示序列 s₀, s₁, ..., s_{n-1}

## 输出格式

一个整数，表示序列的第m项 s_{m-1}
